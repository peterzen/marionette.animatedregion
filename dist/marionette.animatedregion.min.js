/*! marionette.animatedregion - v0.3.2
 *  Release on: 2015-01-31
 *  Copyright (c) 2015 StÃ©phane Bachelier
 *  Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define(["marionette","underscore","motioncontrol"],function(c,d,e){return a.AnimatedRegion=b(c,d,e)}):"object"==typeof exports?module.exports=b(require("marionette"),require("underscore"),require("motioncontrol")):a.AnimatedRegion=b(Marionette,_,motioncontrol)}(this,function(a,b,c){"use strict";var d=a.Region.extend({attachHtml:function(c){var d=new MutationObserver(b.bind(function(){d.disconnect(),this.animateView(c,"in")},this)),e={attributes:!1,childList:!0,characterData:!1};d.observe(this.el,e),this.isViewSupportingAnimation=!b.isEmpty(c.animationClassName),a.Region.prototype.attachHtml.call(this,c)},close:function(){var a=this.currentView;if(!a)return this;var c=this.animateView(a,"out");return!1===c?(this.triggerMethod("close"),this):c.then(b.bind(function(){this.triggerMethod("close")},this))},animateView:function(a,d){d=d||"in";var e={trigger:b.bind(b.partial(this.launchAnimation,a,d),this)},f=b.extend(e,b.result(this,"getAnimationOptions"));this.triggerMethod("animate:view:"+d,a);var g=this;return c(a.el,f).then(function(){g.isViewSupportingAnimation&&g.triggerMethod("animated:view:"+d,a)})},launchAnimation:function(a,c){var d="animateView"+c.charAt(0).toUpperCase()+c.substring(1),e=this[d];return this.isViewSupportingAnimation&&b.isFunction(e)?e.call(this,a):this.isViewSupportingAnimation},animateViewIn:function(a){a.animationClassName["in"]&&this.updateClassList(a.el,a.animationClassName["in"],"add")&&this.triggerMethod("animating:view:in")},onAnimatedViewIn:function(a){a.animationClassName.out&&this.updateClassList(a.el,a.animationClassName["in"],"remove")},animateViewOut:function(a){a.animationClassName["in"]&&this.updateClassList(a.el,a.animationClassName.out,"add")&&this.triggerMethod("animating:view:out")},onAnimatedViewOut:function(a){a.animationClassName.out&&this.updateClassList(a.el,a.animationClassName.out,"remove")},updateClassList:function(a,b,c){if(a&&b&&c){var d=a.classList[c];if(!d)return!1;for(var e=b?b.split(" "):[],f=0,g=e.length;g>f;f+=1)a.classList[c](e[f]);return!0}}});return d.extend=a.extend,a.AnimatedRegion=d,d});